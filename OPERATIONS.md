# 📖 Domain MAX 用户操作手册

> **完整的系统使用指南** - 从新手入门到高级管理的全方位操作说明

本文档提供了 **Domain MAX 二级域名分发管理系统** 的完整操作指南，包括用户端功能、管理员功能和日常使用技巧。

## 📋 目录导航

- [🚪 系统访问](#-系统访问) - 如何登录和访问系统
- [👤 用户功能](#-用户功能) - 普通用户操作指南
- [🛡️ 管理员功能](#️-管理员功能) - 管理员专用功能
- [🎯 使用技巧](#-使用技巧) - 提高效率的实用技巧
- [❓ 常见问题](#-常见问题) - FAQ 和问题解答
- [📞 技术支持](#-技术支持) - 获得帮助的方式

---

## 🚪 系统访问

### 系统地址

- **用户门户**: `https://your-domain.com` 或 `http://localhost:8080`
- **管理后台**: `https://your-domain.com/admin` 或 `http://localhost:8080/admin`

### 账户类型

| 账户类型    | 权限范围           | 主要功能                       |
| ----------- | ------------------ | ------------------------------ |
| 👤 普通用户 | 个人域名和记录管理 | DNS 记录增删改查、个人资料管理 |
| 🛡️ 管理员   | 全系统管理         | 用户管理、域名管理、系统配置   |

---

## 👤 用户功能

### 1. 注册与激活

**新用户注册流程**:

1. **访问注册页面**

   - 点击首页的"注册"按钮
   - 或直接访问 `/register`

2. **填写注册信息**

   ```
   邮箱地址: user@example.com  (必填，用于接收激活邮件)
   用户昵称: 我的昵称          (必填，2-50个字符)
   登录密码: ********        (必填，至少8位，包含字母和数字)
   确认密码: ********        (必填，与密码保持一致)
   ```

3. **邮箱验证**

   - 系统发送激活邮件到注册邮箱
   - 点击邮件中的激活链接完成账户激活
   - 激活链接 24 小时内有效

4. **登录系统**
   - 激活成功后即可使用邮箱和密码登录

### 2. 登录与安全

**登录步骤**:

1. 访问系统首页，点击"登录"
2. 输入注册时使用的邮箱和密码
3. 登录成功后跳转到个人仪表盘

**安全特性**:

- 🔒 **安全登录**: 采用 HttpOnly Cookie + CSRF 双重保护
- 🚫 **登录限制**: 连续 5 次密码错误将锁定账户 1 分钟
- 🔑 **密码重置**: 支持通过邮箱重置忘记的密码

**重置密码**:

1. 在登录页面点击"忘记密码"
2. 输入注册邮箱，点击"发送重置邮件"
3. 查收邮件，点击重置链接
4. 输入新密码完成重置

### 3. 个人仪表盘

登录后首先看到的是个人仪表盘，显示：

- 📊 **统计信息**

  - DNS 记录总数
  - 可用域名数量
  - 本月记录变更次数
  - 账户创建时间

- 🔄 **最近活动**

  - 最近创建的 DNS 记录
  - 最近修改的记录
  - 系统通知消息

- ⚡ **快速操作**
  - 添加 DNS 记录
  - 查看所有记录
  - 修改个人资料

### 4. DNS 记录管理

这是系统的核心功能，用户可以管理自己的 DNS 记录。

#### 4.1 查看 DNS 记录

**记录列表界面**:

- 显示所有已创建的 DNS 记录
- 支持按记录类型、域名筛选
- 实时显示记录状态（正常/同步中/错误）

**记录信息包括**:

```
记录名称: www          (子域名前缀)
记录类型: A            (A/CNAME/TXT/MX)
记录值:   192.168.1.1  (目标地址或值)
TTL:     600           (生存时间，秒)
状态:    正常          (同步状态)
创建时间: 2025-01-01 10:00:00
```

#### 4.2 添加 DNS 记录

**操作步骤**:

1. **进入添加页面**

   - 在仪表盘点击"添加 DNS 记录"
   - 或在记录列表页点击"新建记录"

2. **选择主域名**

   - 从下拉列表选择可用的主域名
   - 管理员会预先配置可用的主域名列表

3. **填写记录信息**

   **A 记录示例** (指向 IPv4 地址):

   ```
   主域名: example.com        (选择)
   记录名称: www             (子域名)
   记录类型: A               (选择)
   记录值: 192.168.1.100     (IPv4地址)
   TTL: 600                  (可选，默认600秒)

   最终域名: www.example.com → 192.168.1.100
   ```

   **CNAME 记录示例** (域名别名):

   ```
   主域名: example.com
   记录名称: blog
   记录类型: CNAME
   记录值: myblog.github.io
   TTL: 600

   最终域名: blog.example.com → myblog.github.io
   ```

   **TXT 记录示例** (文本记录，常用于验证):

   ```
   主域名: example.com
   记录名称: _verification
   记录类型: TXT
   记录值: "google-site-verification=abc123"
   TTL: 600
   ```

   **MX 记录示例** (邮件服务器):

   ```
   主域名: example.com
   记录名称: @               (根域名) 或留空
   记录类型: MX
   记录值: 10 mail.example.com  (优先级 + 邮件服务器)
   TTL: 3600
   ```

4. **提交创建**
   - 点击"创建记录"按钮
   - 系统自动同步到 DNS 服务商
   - 同步成功后记录状态显示为"正常"

#### 4.3 修改 DNS 记录

**修改现有记录**:

1. 在记录列表中点击要修改的记录
2. 在详情页点击"编辑"按钮
3. 修改需要变更的字段
4. 点击"保存修改"

**注意事项**:

- 记录名称和域名修改后将创建新记录并删除旧记录
- TTL 修改立即生效
- 记录值修改需要等待 DNS 传播（通常 5-15 分钟）

#### 4.4 删除 DNS 记录

**删除操作**:

1. 在记录详情页点击"删除记录"
2. 确认删除操作
3. 系统自动从 DNS 服务商删除记录

**删除确认**:

- 系统会显示将要删除的记录信息
- 删除操作不可恢复，请谨慎操作

### 5. 个人资料管理

**可修改的信息**:

- 👤 用户昵称
- 🔒 登录密码
- 📧 绑定邮箱（需验证）

**修改步骤**:

1. 点击右上角用户头像，选择"个人资料"
2. 在相应字段进行修改
3. 点击"保存修改"

**安全设置**:

- 修改邮箱需要验证新邮箱
- 修改密码需要输入当前密码
- 重要操作会发送通知邮件

---

## 🛡️ 管理员功能

### 1. 管理员登录

**默认管理员账户**:

- 邮箱: `admin@example.com`
- 密码: `admin123`
- 首次登录后**务必修改密码**

**管理后台访问**:

- 访问 `/admin` 路径
- 使用管理员账户登录
- 进入管理员专用界面

### 2. 系统仪表盘

管理员仪表盘显示全系统统计信息：

**用户统计**:

- 总用户数 / 活跃用户数
- 今日新注册用户
- 用户分布图表

**DNS 记录统计**:

- 总记录数 / 各类型记录数量
- 今日新增/修改记录数
- 记录增长趋势图

**系统状态**:

- 服务运行时间
- 数据库连接状态
- DNS 服务商同步状态
- 系统资源使用情况

### 3. 用户管理

#### 3.1 用户列表

**用户信息显示**:

```
用户ID | 邮箱地址 | 昵称 | 状态 | DNS记录数 | 注册时间 | 最后登录 | 操作
1001   | user@... | 用户A | 正常 | 5       | 2025-01-01 | 2025-01-15 | [编辑][禁用]
1002   | test@... | 用户B | 禁用 | 2       | 2025-01-02 | 2025-01-10 | [编辑][启用]
```

**用户筛选功能**:

- 按状态筛选（正常/禁用/所有）
- 按注册时间筛选
- 按用户昵称搜索
- 按邮箱地址搜索

#### 3.2 用户详情管理

**查看用户详情**:

- 点击用户列表中的用户可查看详细信息
- 显示用户的所有 DNS 记录
- 显示登录历史和操作日志

**用户操作权限**:

- ✅ **编辑用户信息**: 修改昵称、邮箱等基本信息
- ✅ **重置用户密码**: 为用户生成新密码
- ✅ **禁用/启用账户**: 控制用户登录权限
- ✅ **设置记录配额**: 限制用户可创建的记录数量
- ❌ **删除用户**: 当前版本不支持用户删除（数据安全考虑）

**用户状态管理**:

```
正常: 用户可正常登录和使用所有功能
禁用: 用户无法登录，但DNS记录继续工作
锁定: 暂时锁定（如登录失败过多）
```

### 4. 域名管理

#### 4.1 主域名配置

**域名列表显示**:

```
域名          | 类型    | 状态 | DNS服务商 | 记录数量 | 最后同步 | 操作
example.com   | 主域名  | 正常 | DNSPod   | 25      | 5分钟前  | [编辑][同步][删除]
test.org      | 主域名  | 错误 | DNSPod   | 0       | 1小时前  | [编辑][同步][删除]
```

**添加新域名**:

1. 点击"添加域名"按钮
2. 填写域名信息：
   ```
   域名名称: newdomain.com    (必填)
   域名类型: 主域名           (选择)
   描述信息: 新的测试域名     (可选)
   DNS服务商: DNSPod         (选择已配置的服务商)
   ```
3. 点击"添加"完成配置

**域名同步**:

- 手动同步：点击域名列表中的"同步"按钮
- 自动同步：系统每小时自动同步一次
- 同步内容：从 DNS 服务商获取域名的所有记录

#### 4.2 域名状态管理

**域名状态说明**:

- 🟢 **正常**: 域名可正常使用，同步正常
- 🟡 **警告**: 部分功能异常，如同步延迟
- 🔴 **错误**: 域名无法使用，如 DNS 服务商连接失败

**处理异常域名**:

1. 查看错误详情
2. 检查 DNS 服务商配置
3. 重新配置或删除异常域名

### 5. DNS 服务商管理

#### 5.1 服务商配置

**当前支持的服务商**:

- ✅ **DNSPod (腾讯云)**: 完整支持，推荐使用
- 📋 **阿里云 DNS**: 计划支持
- 📋 **Cloudflare**: 计划支持

**添加 DNSPod 配置**:

1. **获取 API 凭证**:

   - 登录 DNSPod 控制台
   - 进入"API 密钥管理"
   - 创建密钥，获取 ID 和 Token

2. **系统中配置**:

   ```
   服务商名称: DNSPod主账户    (自定义名称)
   服务商类型: dnspod         (选择)
   API配置:
     Token ID: 123456          (DNSPod提供的ID)
     Token: abcdef123456789    (DNSPod提供的Token)
   描述: 主账户DNSPod接口      (可选)
   状态: 启用                 (选择)
   ```

3. **测试连接**:
   - 配置完成后点击"测试连接"
   - 系统会验证 API 凭证有效性
   - 测试成功后即可使用

#### 5.2 服务商状态监控

**连接状态监控**:

- 🟢 **正常**: API 连接正常，可正常同步
- 🟡 **限制**: API 达到限制，同步可能延迟
- 🔴 **失败**: API 连接失败，无法同步

**处理连接异常**:

1. 检查 API 凭证是否过期
2. 确认服务商账户状态
3. 查看详细错误日志
4. 更新或重新配置凭证

### 6. 系统配置

#### 6.1 SMTP 邮件配置

**配置邮件服务**:

```
SMTP服务器: smtp.gmail.com    (邮件服务器地址)
SMTP端口: 587                 (通常587或465)
发件人邮箱: noreply@yourdomain.com
发件人名称: Domain MAX系统
用户名: your_email@gmail.com   (SMTP认证用户名)
密码: your_app_password        (应用专用密码，非邮箱密码)
加密方式: TLS                  (TLS/SSL/无)
```

**邮件模板管理**:

- 📧 **注册验证邮件**: 用户注册时发送
- 🔑 **密码重置邮件**: 密码重置时发送
- 📢 **系统通知邮件**: 重要变更通知

**测试邮件发送**:

- 配置完成后可发送测试邮件
- 确保邮件能正常到达目标邮箱
- 检查邮件内容和格式

#### 6.2 系统安全设置

**安全参数配置**:

```
密码策略:
- 最小长度: 8位
- 必须包含: 字母+数字
- 禁用弱密码: 启用

登录安全:
- 登录失败限制: 5次/分钟
- 账户锁定时间: 15分钟
- 强制密码更新: 90天

API限制:
- 通用接口: 100次/分钟
- DNS操作: 10次/分钟
- 登录接口: 5次/分钟
```

**会话管理**:

- JWT 访问令牌有效期: 24 小时
- 刷新令牌有效期: 30 天
- 自动登出时间: 2 小时无操作

---

## 🎯 使用技巧

### 1. DNS 记录最佳实践

**记录命名规范**:

```
常用子域名:
www     - 网站主页
blog    - 博客
api     - API接口
mail    - 邮件服务
ftp     - 文件服务
test    - 测试环境
dev     - 开发环境
```

**TTL 值选择建议**:

```
600秒 (10分钟)  - 默认值，适合大部分场景
300秒 (5分钟)   - 需要快速生效的记录
3600秒 (1小时)  - 稳定的服务，如邮件服务器
86400秒 (1天)   - 非常稳定的记录
```

**记录类型选择**:

- **A 记录**: 指向 IPv4 地址的服务器
- **CNAME**: 域名别名，不能与其他记录类型共存
- **TXT**: 域名验证、SPF 记录等
- **MX**: 邮件服务器配置

### 2. 批量操作技巧

**快速创建相似记录**:

1. 创建第一条记录
2. 在记录详情页点击"复制为模板"
3. 修改名称和值快速创建新记录

**记录导入导出**:

- 支持 CSV 格式批量导入 DNS 记录
- 可导出当前记录用于备份

**批量修改 TTL**:

- 在记录列表选择多个记录
- 点击"批量操作" → "修改 TTL"

### 3. 监控与维护

**记录状态监控**:

- 定期检查记录同步状态
- 关注同步失败的记录并及时处理
- 设置邮件通知获取状态变更

**性能优化**:

- 清理不使用的记录减少同步负担
- 合理设置 TTL 值平衡性能和灵活性
- 定期清理测试记录

### 4. 安全实践

**账户安全**:

- 使用强密码并定期更换
- 不与他人共享管理员账户
- 定期查看登录日志

**DNS 安全**:

- 不要创建指向私有 IP 的公共记录
- 谨慎设置 TXT 记录，避免泄露敏感信息
- 定期审查 DNS 记录的合理性

---

## ❓ 常见问题

### 用户常见问题

**Q: 为什么 DNS 记录创建后不能立即访问？**
A: DNS 记录需要时间传播到全球 DNS 服务器，通常需要 5-15 分钟。可以使用在线 DNS 查询工具检查传播状态。

**Q: 支持泛域名记录吗？**
A: 当前版本不支持泛域名（\*.example.com）记录，计划在后续版本中添加。

**Q: 如何验证 DNS 记录是否生效？**
A: 可以使用以下命令验证：

```bash
# Windows
nslookup your-domain.com

# Linux/Mac
dig your-domain.com
```

**Q: 忘记密码怎么办？**
A: 在登录页面点击"忘记密码"，输入注册邮箱获取重置链接。

**Q: 可以创建多少条 DNS 记录？**
A: 默认每个用户可创建 50 条记录，管理员可以调整此限制。

### 管理员常见问题

**Q: 如何备份 DNS 记录数据？**
A: 参考 [部署指南](./DEPLOYMENT.md) 中的数据备份章节，使用自动化脚本定期备份。

**Q: 用户无法接收验证邮件？**
A: 检查 SMTP 配置，确认发件邮箱设置正确，可发送测试邮件验证。

**Q: DNS 服务商同步失败怎么处理？**
A: 检查 API 凭证是否正确，服务商账户是否正常，查看详细错误日志定位问题。

**Q: 如何限制用户创建记录数量？**
A: 在用户管理页面编辑用户信息，设置"DNS 记录配额"字段。

**Q: 系统支持多个 DNS 服务商同时使用吗？**
A: 当前版本每个域名只能配置一个 DNS 服务商，但系统可以同时管理使用不同服务商的域名。

### 技术问题

**Q: 系统对记录名称有什么限制？**
A:

- 长度: 1-63 个字符
- 字符: 字母、数字、连字符（-）
- 不能以连字符开头或结尾
- 不区分大小写

**Q: 支持 IPv6 (AAAA 记录) 吗？**
A: 当前版本暂不支持 AAAA 记录，计划在 v1.2 版本中添加。

**Q: 如何查看 API 调用日志？**
A: 管理员可以在系统日志中查看详细的 API 调用记录和错误信息。

---

## 📞 技术支持

### 获得帮助的方式

1. **📚 查阅文档**

   - [部署指南](./DEPLOYMENT.md) - 部署和运维问题
   - [安全升级指南](./SECURITY-UPGRADES.md) - 安全相关问题

2. **🐛 问题反馈**

   - GitHub Issues: [提交问题](https://github.com/Domain-MAX/Domain-MAX/issues)
   - 包含详细的错误信息和操作步骤

3. **💬 社区讨论**
   - GitHub Discussions: [参与讨论](https://github.com/Domain-MAX/Domain-MAX/discussions)
   - 功能建议和使用交流

### 反馈问题时请提供

- 系统版本信息
- 浏览器类型和版本
- 详细的操作步骤
- 错误截图或日志信息
- 环境信息（Docker/源码部署）

---

**🎉 感谢使用 Domain MAX 系统！希望这个操作手册能帮助您更好地使用系统功能。**
